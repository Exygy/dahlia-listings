#!/bin/sh

######
# NOTE:
# Even though this is setup as a shell script, for whatever reason running ./bin/git-sync-translations
# doesn't seem to run all the steps properly, it only really works if you copy/paste the below into
# your terminal and run it from there. Must be something about the shell user and the way it runs
# the git operations.
######

# reset the translations branch to == master
git checkout master
git branch -D translations
git checkout -b translations
git push origin translations --force

# sync translation terms Github <-> POE
curl https://poeditor.com/api/webhooks/github?api_token=925b1c73349548271f2f228f8a7b3ce1&id_project=57183&language=en&operation=sync_terms_and_translations

### enable when other languages have been translated
# curl https://poeditor.com/api/webhooks/github?api_token=925b1c73349548271f2f228f8a7b3ce1&id_project=57183&language=es&operation=sync_terms_and_translations
# curl https://poeditor.com/api/webhooks/github?api_token=925b1c73349548271f2f228f8a7b3ce1&id_project=57183&language=zh-CN&operation=sync_terms_and_translations
# curl https://poeditor.com/api/webhooks/github?api_token=925b1c73349548271f2f228f8a7b3ce1&id_project=57183&language=tl&operation=sync_terms_and_translations

# commit latest translations from POE -> Github
curl https://poeditor.com/api/webhooks/github?api_token=925b1c73349548271f2f228f8a7b3ce1&id_project=57183&language=en&operation=export_terms_and_translations

### enable when other languages have been translated
# curl https://poeditor.com/api/webhooks/github?api_token=925b1c73349548271f2f228f8a7b3ce1&id_project=57183&language=es&operation=export_terms_and_translations
# curl https://poeditor.com/api/webhooks/github?api_token=925b1c73349548271f2f228f8a7b3ce1&id_project=57183&language=tl&operation=export_terms_and_translations
# curl https://poeditor.com/api/webhooks/github?api_token=925b1c73349548271f2f228f8a7b3ce1&id_project=57183&language=zh-CN&operation=export_terms_and_translations

# re-sort the file and push again
git pull origin translations
grunt translations
git commit public/translations/* -m '[translations] sorted translations after POEditor merge'
git push origin translations
